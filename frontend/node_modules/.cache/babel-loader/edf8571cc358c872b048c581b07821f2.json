{"ast":null,"code":"var _jsxFileName = \"/Users/fjpu/Code/frontend-postApp/src/containers/Login/Login.component.tsx\";\nimport React, { useState, useContext, useEffect, useReducer } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport styles from './Login.module.scss';\nimport Button from '../../components/Button';\nimport TextInput from '../../components/TextInput';\nimport * as authEndpoints from '../../endpoints/auth';\nimport UserContext from '../../helpers/context';\n\nfunction Login() {\n  // React-context to access current connected user\n  const contextUser = useContext(UserContext); // React-router history\n\n  const history = useHistory(); // Fetch hooks for sigin and singup\n  // Signin state\n\n  const [signinEmail, setSigninEmail] = useState('');\n  const [signinPassword, setSigninPassword] = useState('');\n  const [incorrectUserPasswordError, setIncorrectUserPasswordError] = useState(''); // Signup state\n\n  const initialState = {\n    signupName: '',\n    signupSurname: '',\n    signupEmail: '',\n    signupPassword: ''\n  };\n\n  const reducer = (signupState, action) => {\n    switch (action.type) {\n      case 'supName':\n        return { ...signupState,\n          signupName: action.payload\n        };\n\n      case 'supSurname':\n        return { ...signupState,\n          signupSurname: action.payload\n        };\n\n      case 'supEmail':\n        return { ...signupState,\n          signupEmail: action.payload\n        };\n\n      case 'supPassword':\n        return { ...signupState,\n          signupPassword: action.payload\n        };\n\n      default:\n        return signupState;\n    }\n  };\n\n  const [signupState, dispatch] = useReducer(reducer, initialState); // Signin email change handler\n\n  const onSigninEmailChangeHandler = e => {\n    setSigninEmail(e.currentTarget.value);\n  }; // Signin password change handler\n\n\n  const onSigninPasswordChangeHandler = e => {\n    setSigninPassword(e.currentTarget.value);\n  }; // Signup email change handler\n\n\n  const onSignupStateHandler = (e, actionType) => {\n    dispatch({\n      type: actionType,\n      payload: e.currentTarget.value\n    });\n  }; // Function triggered when submiting sign in\n\n\n  const onSigninSubmit = async event => {\n    event.preventDefault();\n    const login = {\n      email: signinEmail,\n      password: signinPassword\n    };\n\n    try {\n      const res = await authEndpoints.signin(login); // checks if res has an user property\n\n      if (res.user) {\n        // Sets current user in context\n        await contextUser.setUser(res.user); // Pushes to home screen\n\n        history.push('./home');\n      } else {\n        setIncorrectUserPasswordError('The email and/or password are not correct');\n      }\n    } catch (err) {\n      history.push('./notfound');\n    }\n  }; // Autologin after user is set if the local storage contains it\n\n\n  useEffect(() => {\n    const autologin = () => {\n      if (contextUser.user) {\n        history.push('./home');\n      }\n    };\n\n    autologin();\n  }, [contextUser.user, history]); // Function triggered when submiting sign up\n\n  const onSignupSubmit = async event => {\n    event.preventDefault();\n    const newUser = {\n      email: signupState.signupEmail,\n      password: signupState.signupPassword,\n      name: signupState.signupName,\n      surname: signupState.signupSurname\n    };\n\n    try {\n      const res = await authEndpoints.signup(newUser);\n\n      if (res) {\n        // Sets current user in context\n        await contextUser.setUser(res.user); // Pushes to home screen\n\n        history.push('./home');\n      }\n    } catch (err) {\n      history.push('./notfound');\n    }\n  };\n\n  const signinRender = /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.signinContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.titleWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, \"Already have an account?\")), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: onSigninSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextInput, {\n    onChange: onSigninEmailChangeHandler,\n    type: \"email\",\n    placeholder: \"Email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextInput, {\n    onChange: onSigninPasswordChangeHandler,\n    type: \"password\",\n    placeholder: \"Password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  })), incorrectUserPasswordError && /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 40\n    }\n  }, incorrectUserPasswordError), /*#__PURE__*/React.createElement(Button, {\n    backgroundFull: true,\n    text: \"Sign in\",\n    color: \"blue\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  })));\n  const signupRender = /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.signupContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.titleWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }, \"Don't have an account?\")), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: onSignupSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextInput, {\n    onChange: e => onSignupStateHandler(e, 'supName'),\n    type: \"text\",\n    placeholder: \"Name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextInput, {\n    onChange: e => onSignupStateHandler(e, 'supSurname'),\n    type: \"text\",\n    placeholder: \"Surname\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextInput, {\n    onChange: e => onSignupStateHandler(e, 'supEmail'),\n    type: \"email\",\n    placeholder: \"Email\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.inputWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextInput, {\n    onChange: e => onSignupStateHandler(e, 'supPassword'),\n    type: \"password\",\n    placeholder: \"Password\",\n    minLength: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Button, {\n    backgroundFull: true,\n    text: \"Join\",\n    color: \"blue\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  })));\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }\n  }, signinRender, signupRender));\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/fjpu/Code/frontend-postApp/src/containers/Login/Login.component.tsx"],"names":["React","useState","useContext","useEffect","useReducer","useHistory","styles","Button","TextInput","authEndpoints","UserContext","Login","contextUser","history","signinEmail","setSigninEmail","signinPassword","setSigninPassword","incorrectUserPasswordError","setIncorrectUserPasswordError","initialState","signupName","signupSurname","signupEmail","signupPassword","reducer","signupState","action","type","payload","dispatch","onSigninEmailChangeHandler","e","currentTarget","value","onSigninPasswordChangeHandler","onSignupStateHandler","actionType","onSigninSubmit","event","preventDefault","login","email","password","res","signin","user","setUser","push","err","autologin","onSignupSubmit","newUser","name","surname","signup","signinRender","signinContainer","titleWrapper","title","inputWrapper","error","signupRender","signupContainer","container"],"mappings":"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","sourcesContent":["import React, {\n  useState, useContext, useEffect, useReducer,\n} from 'react';\nimport { useHistory } from 'react-router-dom';\nimport styles from './Login.module.scss';\nimport Button from '../../components/Button';\nimport TextInput from '../../components/TextInput';\nimport * as authEndpoints from '../../endpoints/auth';\nimport { User } from '../../interfaces';\nimport UserContext from '../../helpers/context';\n\nfunction Login() {\n  // React-context to access current connected user\n  const contextUser = useContext(UserContext);\n\n  // React-router history\n  const history = useHistory();\n\n  // Fetch hooks for sigin and singup\n\n  // Signin state\n  const [signinEmail, setSigninEmail] = useState('');\n  const [signinPassword, setSigninPassword] = useState('');\n  const [incorrectUserPasswordError, setIncorrectUserPasswordError] = useState('');\n\n  // Signup state\n  const initialState = {\n    signupName: '',\n    signupSurname: '',\n    signupEmail: '',\n    signupPassword: '',\n  };\n  type ActionType = 'supName' | 'supSurname' | 'supEmail' | 'supPassword'\n  type Action = { type: ActionType; payload: string };\n\n  const reducer = (signupState: typeof initialState, action: Action) => {\n    switch (action.type) {\n      case 'supName':\n        return { ...signupState, signupName: action.payload };  \n      case 'supSurname':\n        return { ...signupState, signupSurname: action.payload };\n      case 'supEmail':\n        return { ...signupState, signupEmail: action.payload };\n      case 'supPassword':\n        return { ...signupState, signupPassword: action.payload };\n      default:\n        return signupState;\n    }\n  };\n  const [signupState, dispatch] = useReducer(reducer, initialState);\n\n  // Signin email change handler\n  const onSigninEmailChangeHandler = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSigninEmail(e.currentTarget.value);\n  };\n\n  // Signin password change handler\n  const onSigninPasswordChangeHandler = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setSigninPassword(e.currentTarget.value);\n  };\n\n  // Signup email change handler\n  const onSignupStateHandler = (e: React.ChangeEvent<HTMLInputElement>, actionType: ActionType) => {\n    dispatch({ type: actionType, payload: e.currentTarget.value });\n  };\n\n  // Function triggered when submiting sign in\n  const onSigninSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const login = {\n      email: signinEmail,\n      password: signinPassword,\n    };\n\n    try {\n      const res: { user: User, token: string } = await authEndpoints.signin(login);\n      // checks if res has an user property\n      if (res.user) {\n        // Sets current user in context\n        await contextUser.setUser(res.user);\n        // Pushes to home screen\n        history.push('./home');\n      } else {\n        setIncorrectUserPasswordError('The email and/or password are not correct');\n      }\n    } catch (err) {\n      history.push('./notfound');\n    }\n  };\n\n  // Autologin after user is set if the local storage contains it\n  useEffect(() => {\n    const autologin = () => {\n      if (contextUser.user) {\n        history.push('./home');\n      }\n    };\n    autologin();\n  }, [contextUser.user, history]);\n\n  // Function triggered when submiting sign up\n  const onSignupSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const newUser: User = {\n      email: signupState.signupEmail,\n      password: signupState.signupPassword,\n      name: signupState.signupName,\n      surname: signupState.signupSurname,\n    };\n    try {\n      const res: { user: User, token: string } = await authEndpoints.signup(newUser);\n      if (res) {\n        // Sets current user in context\n        await contextUser.setUser(res.user);\n        // Pushes to home screen\n        history.push('./home');\n      }\n    } catch (err) {\n      history.push('./notfound');\n    }\n  };\n\n  const signinRender = (\n    <div className={styles.signinContainer}>\n      <div className={styles.titleWrapper}>\n        <h1 className={styles.title}>Already have an account?</h1>\n      </div>\n      <form onSubmit={onSigninSubmit}>\n        <div className={styles.inputWrapper}>\n          <TextInput\n            onChange={onSigninEmailChangeHandler}\n            type=\"email\"\n            placeholder=\"Email\"\n          />\n        </div>\n        <div className={styles.inputWrapper}>\n          <TextInput\n            onChange={onSigninPasswordChangeHandler}\n            type=\"password\"\n            placeholder=\"Password\"\n          />\n        </div>\n        {incorrectUserPasswordError && <p className={styles.error}>{incorrectUserPasswordError}</p>}\n        <Button\n          backgroundFull\n          text=\"Sign in\"\n          color=\"blue\"\n          type=\"submit\"\n        />\n      </form>\n    </div>\n  );\n\n  const signupRender = (\n    <div className={styles.signupContainer}>\n      <div className={styles.titleWrapper}>\n        <h1 className={styles.title}>Don&apos;t have an account?</h1>\n      </div>\n      <form onSubmit={onSignupSubmit}>\n        <div className={styles.inputWrapper}>\n          <TextInput onChange={(e) => onSignupStateHandler(e, 'supName')} type=\"text\" placeholder=\"Name\" />\n        </div>\n        <div className={styles.inputWrapper}>\n          <TextInput onChange={(e) => onSignupStateHandler(e, 'supSurname')} type=\"text\" placeholder=\"Surname\" />\n        </div>\n        <div className={styles.inputWrapper}>\n          <TextInput onChange={(e) => onSignupStateHandler(e, 'supEmail')} type=\"email\" placeholder=\"Email\" />\n        </div>\n        <div className={styles.inputWrapper}>\n          <TextInput\n            onChange={(e) => onSignupStateHandler(e, 'supPassword')}\n            type=\"password\"\n            placeholder=\"Password\"\n            minLength={6}\n          />\n        </div>\n        <Button\n          backgroundFull\n          text=\"Join\"\n          color=\"blue\"\n          type=\"submit\"\n        />\n      </form>\n    </div>\n  );\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.container}>\n        {signinRender}\n        {signupRender}\n      </div>\n    </div>\n  );\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}